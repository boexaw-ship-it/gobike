<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Customer Order - GoBike</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="../css/style.css">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="../js/firebase-config.js"></script>

<style>
  .app { padding: 15px; font-family: sans-serif; max-width: 500px; margin:auto; }
  input, textarea { width: 100%; padding: 8px; margin:5px 0; }
  button { padding:10px 15px; margin-top:10px; cursor:pointer; }
  #status { margin-top:10px; font-weight:bold; }
</style>

</head>
<body>

<div class="app">
  <h2>Create Order</h2>

  <input id="customerName" placeholder="Your Name">
  <input id="destination" placeholder="Delivery Destination">
  <textarea id="note" placeholder="Additional Note (optional)"></textarea>
  <button onclick="createOrder()">Place Order</button>

  <p id="status"></p>
</div>

<script>
let uid = null;

// Anonymous login
auth.signInAnonymously()
.then(res=>{
  uid = res.user.uid;
})
.catch(err=>{
  alert("Auth error: "+err.message);
});

function createOrder(){
  const name = document.getElementById("customerName").value.trim();
  const dest = document.getElementById("destination").value.trim();
  const note = document.getElementById("note").value.trim();

  if(!name || !dest){
    alert("Name and Destination required");
    return;
  }

  db.collection("orders").add({
    customerId: uid,
    customerName: name,
    destination: dest,
    note: note,
    status: "pending",
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  }).then(()=>{
    document.getElementById("status").innerText = "Order placed successfully!";
    document.getElementById("customerName").value="";
    document.getElementById("destination").value="";
    document.getElementById("note").value="";
  }).catch(err=>{
    document.getElementById("status").innerText = "Error: "+err.message;
  });
}
</script>

</body>
</html>
